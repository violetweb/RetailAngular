/**
 * State-based routing for AngularJS
 * @version v0.2.0-dev-2013-11-11
 * @link http://angular-ui.github.com/
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
typeof module!="undefined"&&typeof exports!="undefined"&&module.exports===exports&&(module.exports="ui.router"),function(n,t,i){"use strict";function l(n,t){return f(new(f(function(){},{prototype:n})),t)}function y(n){return u(arguments,function(t){t!==n&&u(t,function(t,i){n.hasOwnProperty(i)||(n[i]=t)})}),n}function it(n,t){var r=[];for(var i in n.path)if(n.path[i]!==""){if(!t.path[i])break;r.push(n.path[i])}return r}function p(n,t,i,r){var o=it(i,r),u,h={},c=[],s,e;for(s in o)if(o[s].params&&o[s].params.length){u=o[s].params;for(e in u)c.indexOf(u[e])>=0||(c.push(u[e]),h[u[e]]=n[u[e]])}return f({},h,t)}function w(n,t){var s=1,c=2,o={},l=[],a=o,v=f(n.when(o),{$$promises:o,$$values:o});this.study=function(o){function k(n,i){if(b[i]!==c){if(w.push(i),b[i]===s){w.splice(0,w.indexOf(i));throw new Error("Cyclic dependency: "+w.join(" -> "));}if(b[i]=s,e(n))p.push(i,[function(){return t.get(n)}],l);else{var r=t.annotate(n);u(r,function(n){n!==i&&o.hasOwnProperty(n)&&k(o[n],n)});p.push(i,n,r)}w.pop();b[i]=c}}function d(n){return h(n)&&n.then&&n.$$promises}if(!h(o))throw new Error("'invocables' must be an object");var p=[],w=[],b={};return u(o,k),o=w=b=null,function(e,o,s){function k(){--rt||(tt||y(l,o.$$values),c.$$values=l,c.$$promises=!0,g.resolve(l))}function nt(n){c.$$failure=n;g.reject(n)}function ut(i,f,o){function v(n){h.reject(n);nt(n)}function y(){if(!r(c.$$failure))try{h.resolve(t.invoke(f,s,l));h.promise.then(function(n){l[i]=n;k()},v)}catch(n){v(n)}}var h=n.defer(),a=0;u(o,function(n){b.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(a++,b[n].then(function(t){l[n]=t;--a||y()},v))});a||y();b[i]=h.promise}var w,it;if(d(e)&&s===i&&(s=o,o=e,e=null),e){if(!h(e))throw new Error("'locals' must be an object");}else e=a;if(o){if(!d(o))throw new Error("'parent' must be a promise returned by $resolve.resolve()");}else o=v;var g=n.defer(),c=g.promise,b=c.$$promises={},l=f({},e),rt=1+p.length/3,tt=!1;if(r(o.$$failure))return nt(o.$$failure),c;for(o.$$values?(tt=y(l,o.$$values),k()):(f(b,o.$$promises),o.then(k,nt)),w=0,it=p.length;w<it;w+=3)e.hasOwnProperty(p[w])?k():ut(p[w],p[w+1],p[w+2]);return c}};this.resolve=function(n,t,i,r){return this.study(n)(t,i,r)}}function b(n,t,i){this.fromConfig=function(n,t,i){return r(n.template)?this.fromString(n.template,t):r(n.templateUrl)?this.fromUrl(n.templateUrl,t):r(n.templateProvider)?this.fromProvider(n.templateProvider,t,i):null};this.fromString=function(n,t){return o(n)?n(t):n};this.fromUrl=function(i,r){return o(i)&&(i=i(r)),i==null?null:n.get(i,{cache:t}).then(function(n){return n.data})};this.fromProvider=function(n,t,r){return i.invoke(n,null,r||{params:t})}}function s(n){function c(t){if(!/^\w+(-+\w+)*$/.test(t))throw new Error("Invalid parameter name '"+t+"' in pattern '"+n+"'");if(h[t])throw new Error("Duplicate parameter name '"+t+"' in pattern '"+n+"'");h[t]=!0;p.push(t)}function l(n){return n.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&")}var s=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,h={},e="^",f=0,i,o=this.segments=[],p=this.params=[],a,v,t,r,y;for(this.source=n;i=s.exec(n);){if(a=i[2]||i[3],v=i[4]||(i[1]=="*"?".*":"[^/]*"),t=n.substring(f,i.index),t.indexOf("?")>=0)break;e+=l(t)+"("+v+")";c(a);o.push(t);f=s.lastIndex}t=n.substring(f);r=t.indexOf("?");r>=0?(y=this.sourceSearch=t.substring(r),t=t.substring(0,r),this.sourcePath=n.substring(0,f+r),u(y.substring(1).split(/[&?]/),c)):(this.sourcePath=n,this.sourceSearch="");e+=l(t)+"$";o.push(t);this.regexp=new RegExp(e);this.prefix=o[0]}function rt(){this.compile=function(n){return new s(n)};this.isMatcher=function(n){return h(n)&&o(n.exec)&&o(n.format)&&o(n.concat)};this.$get=function(){return this}}function k(n){function s(n){var t=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(n.source);return t!=null?t[1].replace(/\\(.)/g,"$1"):""}function h(n,t){return n.replace(/\$(\$|\d{1,2})/,function(n,i){return t[i==="$"?0:Number(i)]})}function u(n,t,i){if(!i)return!1;var u=n.invoke(t,t,{$match:i});return r(u)?u:!0}var t=[],i=null;this.rule=function(n){if(!o(n))throw new Error("'rule' must be a function");return t.push(n),this};this.otherwise=function(n){if(e(n)){var t=n;n=function(){return t}}else if(!o(n))throw new Error("'rule' must be a function");return i=n,this};this.when=function(t,i){var r,l=e(i),y,a,v;if(e(t)&&(t=n.compile(t)),!l&&!o(i)&&!c(i))throw new Error("invalid 'handler' in when()");y={matcher:function(t,i){return l&&(r=n.compile(i),i=["$match",function(n){return r.format(n)}]),f(function(n,r){return u(n,i,t.exec(r.path(),r.search()))},{prefix:e(t.prefix)?t.prefix:""})},regex:function(n,t){if(n.global||n.sticky)throw new Error("when() RegExp must not be global or sticky");return l&&(r=t,t=["$match",function(n){return h(r,n)}]),f(function(i,r){return u(i,t,n.exec(r.path()))},{prefix:s(n)})}};a={matcher:n.isMatcher(t),regex:t instanceof RegExp};for(v in a)if(a[v])return this.rule(y[v](t,i));throw new Error("invalid 'what' in when()");};this.$get=["$location","$rootScope","$injector",function(n,r,u){function f(){function f(t){var i=t(u,n);return i?(e(i)&&n.replace().url(i),!0):!1}for(var o=t.length,r=0;r<o;r++)if(f(t[r]))return;i&&f(i)}return r.$on("$locationChangeSuccess",f),{}}]}function d(n,s,a){function ut(n){return n.indexOf(".")===0||n.indexOf("^")===0}function k(n,t){var h=e(n),u=h?n:n.name,c=ut(u),s;if(c){if(!t)throw new Error("No reference point given for path '"+u+"'");for(var r=u.split("."),f=0,l=r.length,o=t;f<l;f++){if(r[f]===""&&f===0){o=t;continue}if(r[f]==="^"){if(!o.parent)throw new Error("Path '"+u+"' not valid for state '"+t.name+"'");o=o.parent;continue}break}r=r.slice(f).join(".");u=o.name+(o.name&&r?".":"")+r}return(s=g[u],s&&(h||!h&&(s===n||s.self===n)))?s:i}function ft(n,t){d[n]||(d[n]=[]);d[n].push(t)}function nt(t){var i,u,r,f;if(t=l(t,{self:t,resolve:t.resolve||{},toString:function(){return this.name}}),i=t.name,!e(i)||i.indexOf("@")>=0)throw new Error("State must have a valid name");if(g.hasOwnProperty(i))throw new Error("State '"+i+"'' is already defined");if(u=i.indexOf(".")!==-1?i.substring(0,i.lastIndexOf(".")):e(t.parent)?t.parent:"",u&&!g[u])return ft(u,t.self);for(r in w)o(w[r])&&(t[r]=w[r](t,w.$delegates[r]));if(g[i]=t,!t.abstract&&t.url&&n.when(t.url,["$match","$stateParams",function(n,i){y.$current.navigable==t&&rt(n,i)||y.transitionTo(t,n,!1)}]),d[i])for(f=0;f<d[i].length;f++)nt(d[i][f]);return t}function et(n,t){return e(n)&&!r(t)?w[n]:!o(t)||!e(n)?this:(w[n]&&!w.$delegates[n]&&(w.$delegates[n]=w[n]),w[n]=t,this)}function ot(n,t){return h(n)?t=n:t.name=n,nt(t),this}function tt(n,e,s,h,w,d,nt){function tt(){nt.url()!==ft&&(nt.url(ft),nt.replace())}function ct(n,i,r,f,l){var y=r?i:st(n.params,i),a={$stateParams:y},v;return l.resolve=w.resolve(n.resolve,a,l.resolve,n),v=[l.resolve.then(function(n){l.globals=n})],f&&v.push(f),u(n.views,function(i,r){var u=i.resolve&&i.resolve!==n.resolve?i.resolve:{};u.$template=[function(){return s.load(r,{view:i,locals:a,params:y,notify:!1})||""}];v.push(w.resolve(u,a,l.resolve,n).then(function(f){if(o(i.controllerProvider)||c(i.controllerProvider)){var e=t.extend({},u,a);f.$$controller=h.invoke(i.controllerProvider,null,e)}else f.$$controller=i.controller;f.$$state=n;l[r]=f}))}),e.all(v).then(function(){return l})}var ut=e.reject(new Error("transition superseded")),ot=e.reject(new Error("transition prevented")),et=e.reject(new Error("transition aborted")),ht=e.reject(new Error("transition failed")),ft=nt.url();return b.locals={resolve:null,globals:{$stateParams:{}}},y={params:{},current:b.self,$current:b,transition:null},y.reload=function(){y.transitionTo(y.current,d,{reload:!0,inherit:!1,notify:!1})},y.go=function(n,t,i){return this.transitionTo(n,t,f({inherit:!0,relative:y.$current},i))},y.transitionTo=function(t,i,u){var o,yt,pt,vt,wt;i=i||{};u=f({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},u||{});var a=y.$current,at=y.params,bt=a.path,w,g=k(t,u.relative);if(!r(g)){if(o={to:t,toParams:i,options:u},w=n.$broadcast("$stateNotFound",o,a.self,at),w.defaultPrevented)return tt(),et;if(w.retry)return u.$retry?(tt(),ht):(yt=y.transition=e.when(w.retry),yt.then(function(){return yt!==y.transition?ut:(o.options.$retry=!0,y.transitionTo(o.to,o.toParams,o.options))},function(){return et}),tt(),yt);if(t=o.to,i=o.toParams,u=o.options,g=k(t,u.relative),!r(g)){if(u.relative)throw new Error("Could not resolve '"+t+"' from state '"+u.relative+"'");throw new Error("No such state '"+t+"'");}}if(g.abstract)throw new Error("Cannot transition to abstract state '"+t+"'");u.inherit&&(i=p(d,i||{},y.$current,g));t=g;for(var st=t.path,lt=b.locals,kt=[],s=0,c=st[s];c&&c===bt[s]&&rt(i,at,c.ownParams)&&!u.reload;s++,c=st[s])lt=kt[s]=c.locals;if(t===a&&lt===a.locals&&!u.reload)return tt(),y.transition=null,e.when(y.current);if(i=it(t.params,i||{}),u.notify&&(w=n.$broadcast("$stateChangeStart",t.self,i,a.self,at),w.defaultPrevented))return tt(),ot;for(pt=e.when(lt),vt=s;vt<st.length;vt++,c=st[vt])lt=kt[vt]=l(lt),pt=ct(c,i,c===t,pt,lt);return wt=y.transition=pt.then(function(){var r,f,e,o;if(y.transition!==wt)return ut;for(r=bt.length-1;r>=s;r--)e=bt[r],e.self.onExit&&h.invoke(e.self.onExit,e.self,e.locals.globals),e.locals=null;for(r=s;r<st.length;r++)f=st[r],f.locals=kt[r],f.self.onEnter&&h.invoke(f.self.onEnter,f.self,f.locals.globals);return y.transition!==wt?ut:(y.$current=t,y.current=t.self,y.params=i,v(y.params,d),y.transition=null,o=t.navigable,u.location&&o&&(nt.url(o.url.format(o.locals.globals.$stateParams)),u.location==="replace"&&nt.replace()),u.notify&&n.$broadcast("$stateChangeSuccess",t.self,i,a.self,at),ft=nt.url(),y.current)},function(r){return y.transition!==wt?ut:(y.transition=null,n.$broadcast("$stateChangeError",t.self,i,a.self,at,r),tt(),e.reject(r))})},y.is=function(n,u){var f=k(n);return r(f)?y.$current!==f?!1:r(u)?t.equals(d,u):!0:i},y.includes=function(n,u){var e=k(n),f;return r(e)?r(y.$current.includes[e.name])?(f=!0,t.forEach(u,function(n,t){r(d[t])&&d[t]===n||(f=!1)}),f):!1:i},y.href=function(n,t,i){var e,o,u;return(i=f({lossy:!0,inherit:!1,absolute:!1,relative:y.$current},i||{}),e=k(n,i.relative),!r(e))?null:(t=p(d,t||{},y.$current,e),o=e&&i.lossy?e.navigable:e,u=o&&o.url?o.url.format(it(e.params,t||{})):null,!a.html5Mode()&&u&&(u="#"+a.hashPrefix()+u),i.absolute&&u&&(u=nt.protocol()+"://"+nt.host()+(nt.port()==80||nt.port()==443?"":":"+nt.port())+(!a.html5Mode()&&u?"/":"")+u),u)},y.get=function(n){var i,t;return r(n)?(t=k(n),t&&t.self?t.self:null):(i=[],u(g,function(n){i.push(n.self)}),i)},y}function it(n,t){var i={};return u(n,function(n){var r=t[n];i[n]=r!=null?String(r):null}),i}function rt(n,t,i){var f,r,u;if(!i){i=[];for(f in n)i.push(f)}for(r=0;r<i.length;r++)if(u=i[r],n[u]!=t[u])return!1;return!0}function st(n,t){var i={};return u(n,function(n){i[n]=t[n]}),i}var b,g={},y,d={},w={parent:function(n){if(r(n.parent)&&n.parent)return k(n.parent);var t=/^(.+)\.[^.]+$/.exec(n.name);return t?k(t[1]):b},data:function(n){return n.parent&&n.parent.data&&(n.data=n.self.data=f({},n.parent.data,n.data)),n.data},url:function(n){var t=n.url;if(e(t))return t.charAt(0)=="^"?s.compile(t.substring(1)):(n.parent.navigable||b).url.concat(t);if(s.isMatcher(t)||t==null)return t;throw new Error("Invalid url '"+t+"' in state '"+n+"'");},navigable:function(n){return n.url?n:n.parent?n.parent.navigable:null},params:function(n){if(!n.params)return n.url?n.url.parameters():n.parent.params;if(!c(n.params))throw new Error("Invalid params in state '"+n+"'");if(n.url)throw new Error("Both params and url specicified in state '"+n+"'");return n.params},views:function(n){var t={};return u(r(n.views)?n.views:{"":n},function(i,r){r.indexOf("@")<0&&(r+="@"+n.parent.name);t[r]=i}),t},ownParams:function(n){var t,i;return n.parent?(t={},u(n.params,function(n){t[n]=!0}),u(n.parent.params,function(i){if(!t[i])throw new Error("Missing required parameter '"+i+"' in state '"+n.name+"'");t[i]=!1}),i=[],u(t,function(n,t){n&&i.push(t)}),i):n.params},path:function(n){return n.parent?n.parent.path.concat(n):[]},includes:function(n){var t=n.parent?f({},n.parent.includes):{};return t[n.name]=!0,t},$delegates:{}};b=nt({name:"",url:"^",views:null,abstract:!0});b.navigable=null;this.decorator=et;this.state=ot;this.$get=tt;tt.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$location","$urlRouter"]}function g(){function n(n,t){return{load:function(i,r){var u;return r=f({template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}},r),r.view&&(u=t.fromConfig(r.view,r.params,r.locals)),u&&r.notify&&n.$broadcast("$viewContentLoading",r),u}}}this.$get=n;n.$inject=["$rootScope","$templateFactory"]}function a(n,i,u,f,e){var s,o,h;try{s=f.get("$animator")}catch(c){}return o=!1,h={restrict:"ECA",terminal:!0,priority:1e3,transclude:!0,compile:function(f,c,l){return function(f,c,a){function tt(t){var r=n.$current&&n.$current.locals[y],o,s,h;if(r!==b){if(o=it(p&&t),o.remove(c),v&&(v.$destroy(),v=null),!r)return b=null,w.state=null,o.restore(nt,c);b=r;w.state=r.$$state;s=i(o.populate(r.$template,c));v=f.$new();r.$$controller&&(r.$scope=v,h=u(r.$$controller,r),c.children().data("$ngControllerController",h));s(v);v.$emit("$viewContentLoaded");g&&v.$eval(g);e()}}var v,b,y=a[h.name]||a.name||"",g=a.onload||"",p=r(s)&&s(f,a),nt=l(f),it=function(n){return{"true":{remove:function(n){p.leave(n.contents(),n)},restore:function(n,t){p.enter(n,t)},populate:function(n,i){var r=t.element("<div><\/div>").html(n).contents();return p.enter(r,i),r}},"false":{remove:function(n){n.html("")},restore:function(n,t){t.append(n)},populate:function(n,t){return t.html(n),t.contents()}}}[n.toString()]},k,w,d;c.append(nt);k=c.parent().inheritedData("$uiView");y.indexOf("@")<0&&(y=y+"@"+(k?k.state.name:""));w={name:y,state:null};c.data("$uiView",w);d=function(){if(!o){o=!0;try{tt(!0)}catch(n){o=!1;throw n;}o=!1}};f.$on("$stateChangeSuccess",d);f.$on("$viewContentLoading",d);tt(!1)}}},h}function ut(n){var t=n.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!t||t.length!==4)throw new Error("Invalid state ref '"+n+"'");return{state:t[1],paramExpr:t[3]||null}}function nt(n){return{restrict:"A",link:function(t,i,r){var u=ut(r.uiSref),f=null,o=n.$current,h=i[0].nodeName==="FORM",l=h?"action":"href",c=!0,e=i.parent().inheritedData("$uiView"),s;(e&&e.state&&e.state.name&&(o=e.state),s=function(t){if(t&&(f=t),c){var r=n.href(u.state,f,{relative:o});if(!r)return c=!1,!1;i[0][l]=r}},u.paramExpr&&(t.$watch(u.paramExpr,function(n){n!==f&&s(n)},!0),f=t.$eval(u.paramExpr)),s(),h)||i.bind("click",function(i){var r=i.which||i.button;r!=1||i.ctrlKey||i.metaKey||i.shiftKey||(n.go(u.state,f,{relative:o}),t.$apply(),i.preventDefault())})}}}function tt(n,t){function u(n){this.locals=n.locals.globals;this.params=this.locals.$stateParams}function s(){this.locals=null;this.params=null}function h(i,f){if(f.redirectTo!=null){var h=f.redirectTo,c;if(e(h))c=h;else if(o(h))c=function(n,t){return h(n,t.path(),t.search())};else throw new Error("Invalid 'redirectTo' in when()");t.when(i,c)}else n.state(l(f,{parent:null,name:"route:"+encodeURIComponent(i),url:i,onEnter:u,onExit:s}));return r.push(f),this}function f(n,t,u){function f(n){return n.name!==""?n:i}var e={routes:r,params:u,current:i};return t.$on("$stateChangeStart",function(n,i,r,u){t.$broadcast("$routeChangeStart",f(i),f(u))}),t.$on("$stateChangeSuccess",function(n,i,r,u){e.current=f(i);t.$broadcast("$routeChangeSuccess",f(i),f(u));v(r,e.params)}),t.$on("$stateChangeError",function(n,i,r,u,e,o){t.$broadcast("$routeChangeError",f(i),f(u),o)}),e}var r=[];u.$inject=["$$state"];this.when=h;this.$get=f;f.$inject=["$state","$rootScope","$routeParams"]}var r=t.isDefined,o=t.isFunction,e=t.isString,h=t.isObject,c=t.isArray,u=t.forEach,f=t.extend,v=t.copy;t.module("ui.router.util",["ng"]);t.module("ui.router.router",["ui.router.util"]);t.module("ui.router.state",["ui.router.router","ui.router.util"]);t.module("ui.router",["ui.router.state"]);t.module("ui.router.compat",["ui.router"]);w.$inject=["$q","$injector"];t.module("ui.router.util").service("$resolve",w);b.$inject=["$http","$templateCache","$injector"];t.module("ui.router.util").service("$templateFactory",b);s.prototype.concat=function(n){return new s(this.sourcePath+n+this.sourceSearch)};s.prototype.toString=function(){return this.source};s.prototype.exec=function(n,t){var u=this.regexp.exec(n);if(!u)return null;var r=this.params,o=r.length,e=this.segments.length-1,f={},i;if(e!==u.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;i<e;i++)f[r[i]]=u[i+1];for(;i<o;i++)f[r[i]]=t[r[i]];return f};s.prototype.parameters=function(){return this.params};s.prototype.format=function(n){var r=this.segments,u=this.params;if(!n)return r.join("");for(var o=r.length-1,s=u.length,f=r[0],e,i,t=0;t<o;t++)i=n[u[t]],i!=null&&(f+=encodeURIComponent(i)),f+=r[t+1];for(;t<s;t++)i=n[u[t]],i!=null&&(f+=(e?"&":"?")+u[t]+"="+encodeURIComponent(i),e=!0);return f};t.module("ui.router.util").provider("$urlMatcherFactory",rt);k.$inject=["$urlMatcherFactoryProvider"];t.module("ui.router.router").provider("$urlRouter",k);d.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider"];t.module("ui.router.state").value("$stateParams",{}).provider("$state",d);g.$inject=[];t.module("ui.router.state").provider("$view",g);a.$inject=["$state","$compile","$controller","$injector","$anchorScroll"];t.module("ui.router.state").directive("uiView",a);nt.$inject=["$state"];t.module("ui.router.state").directive("uiSref",nt);tt.$inject=["$stateProvider","$urlRouterProvider"];t.module("ui.router.compat").provider("$route",tt).directive("ngView",a)}(window,window.angular);
//# sourceMappingURL=angular-ui-router.min.js.map
