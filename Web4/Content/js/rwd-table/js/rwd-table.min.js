/*!
 * Responsive Tables v5.0.4 (http://gergeo.se/RWD-Table-Patterns)
 * This is an awesome solution for responsive tables with complex data.
 * Authors: Nadan Gergeo <nadan.gergeo@gmail.com> (www.gergeo.se) & Maggie Wachs (www.filamentgroup.com)
 * Licensed under MIT (https://github.com/nadangergeo/RWD-Table-Patterns/blob/master/LICENSE-MIT)
 */
(function(n){"use strict";function r(){return typeof matchMedia!="undefined"||typeof msMatchMedia!="undefined"||typeof styleMedia!="undefined"}function u(){return"ontouchstart"in window}function f(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))}var t=function(t,i){var r=this;if(this.options=i,this.$tableWrapper=null,this.$tableScrollWrapper=n(t),this.$table=n(t).find("table"),this.$table.length!==1)throw new Error("Exactly one table is expected in a .table-responsive div.");this.$tableScrollWrapper.attr("data-pattern",this.options.pattern);this.id=this.$table.prop("id")||this.$tableScrollWrapper.prop("id")||"id"+Math.random().toString(16).slice(2);this.$tableClone=null;this.$stickyTableHeader=null;this.$thead=this.$table.find("thead");this.$tbody=this.$table.find("tbody");this.$hdrCells=this.$thead.find("th");this.$bodyRows=this.$tbody.find("tr");this.$btnToolbar=null;this.$dropdownGroup=null;this.$dropdownBtn=null;this.$dropdownContainer=null;this.$displayAllBtn=null;this.$focusGroup=null;this.$focusBtn=null;this.displayAllTrigger="display-all-"+this.id+".responsive-table";this.idPrefix=this.id+"-col-";this.iOS=f();this.wrapTable();this.createButtonToolbar();this.setupHdrCells();this.setupStandardCells();this.options.stickyTableHeader&&this.createStickyTableHeader();this.$dropdownContainer.is(":empty")&&this.$dropdownGroup.hide();n(window).bind("orientationchange resize "+this.displayAllTrigger,function(){r.$dropdownContainer.find("input").trigger("updateCheck");n.proxy(r.updateSpanningCells(),r)})},i;t.DEFAULTS={pattern:"priority-columns",stickyTableHeader:!0,fixedNavbar:".navbar-fixed-top",addDisplayAllBtn:!0,addFocusBtn:!0,focusBtnIcon:"glyphicon glyphicon-screenshot"};t.prototype.wrapTable=function(){this.$tableScrollWrapper.wrap('<div class="table-wrapper"/>');this.$tableWrapper=this.$tableScrollWrapper.parent()};t.prototype.createButtonToolbar=function(){var t=this;this.$btnToolbar=n('<div class="btn-toolbar" />');this.$dropdownGroup=n('<div class="btn-group dropdown-btn-group pull-right" />');this.$dropdownBtn=n('<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">Display <span class="caret"><\/span><\/button>');this.$dropdownContainer=n('<ul class="dropdown-menu"/>');this.options.addFocusBtn&&(this.$focusGroup=n('<div class="btn-group focus-btn-group" />'),this.$focusBtn=n('<button class="btn btn-default">Focus<\/button>'),this.options.focusBtnIcon&&this.$focusBtn.prepend('<span class="'+this.options.focusBtnIcon+'"><\/span> '),this.$focusGroup.append(this.$focusBtn),this.$btnToolbar.append(this.$focusGroup),this.$focusBtn.click(function(){n.proxy(t.activateFocus(),t)}),this.$bodyRows.click(function(){n.proxy(t.focusOnRow(n(this)),t)}));this.options.addDisplayAllBtn&&(this.$displayAllBtn=n('<button class="btn btn-default">Display all<\/button>'),this.$dropdownGroup.append(this.$displayAllBtn),this.$table.hasClass("display-all")&&this.$displayAllBtn.addClass("btn-primary"),this.$displayAllBtn.click(function(){n.proxy(t.displayAll(null,!0),t)}));this.$dropdownGroup.append(this.$dropdownBtn).append(this.$dropdownContainer);this.$btnToolbar.append(this.$dropdownGroup);this.$tableScrollWrapper.before(this.$btnToolbar)};t.prototype.clearAllFocus=function(){this.$bodyRows.removeClass("unfocused");this.$bodyRows.removeClass("focused")};t.prototype.activateFocus=function(){this.clearAllFocus();this.$focusBtn&&this.$focusBtn.toggleClass("btn-primary");this.$table.toggleClass("focus-on")};t.prototype.focusOnRow=function(t){if(this.$table.hasClass("focus-on")){var i=n(t).hasClass("focused");this.clearAllFocus();i||(this.$bodyRows.addClass("unfocused"),n(t).addClass("focused"))}};t.prototype.displayAll=function(t,i){this.$displayAllBtn&&this.$displayAllBtn.toggleClass("btn-primary",t);this.$table.toggleClass("display-all",t);this.$tableClone&&this.$tableClone.toggleClass("display-all",t);i&&n(window).trigger(this.displayAllTrigger)};t.prototype.preserveDisplayAll=function(){var t="table-cell";n("html").hasClass("lt-ie9")&&(t="inline");n(this.$table).find("th, td").css("display",t);this.$tableClone&&n(this.$tableClone).find("th, td").css("display",t)};t.prototype.createStickyTableHeader=function(){var t=this;t.$tableClone=t.$table.clone();t.$tableClone.prop("id",this.id+"-clone");t.$tableClone.find("[id]").each(function(){n(this).prop("id",n(this).prop("id")+"-clone")});t.$tableClone.wrap('<div class="sticky-table-header"/>');t.$stickyTableHeader=t.$tableClone.parent();t.$stickyTableHeader.css("height",t.$thead.height()+2);n("html").hasClass("lt-ie10")?t.$tableWrapper.prepend(t.$stickyTableHeader):t.$table.before(t.$stickyTableHeader);n(window).bind("scroll resize",function(){n.proxy(t.updateStickyTableHeader(),t)});n(t.$tableScrollWrapper).bind("scroll",function(){n.proxy(t.updateStickyTableHeader(),t)})};t.prototype.updateStickyTableHeader=function(){var t=this,i=0,u=t.$table.offset().top,r=n(window).scrollTop()-1,f=t.$table.height()-t.$stickyTableHeader.height(),h=r+n(window).height()-n(document).height(),l=!t.iOS,e=0,c,o,s;if(n(t.options.fixedNavbar).length&&(c=n(t.options.fixedNavbar).first(),e=c.height(),r=r+e),o=r>u&&r<u+t.$table.height(),l){if(t.$stickyTableHeader.scrollLeft(t.$tableScrollWrapper.scrollLeft()),t.$stickyTableHeader.addClass("fixed-solution"),i=e-1,r-u>f?(i-=r-u-f,t.$stickyTableHeader.addClass("border-radius-fix")):t.$stickyTableHeader.removeClass("border-radius-fix"),o){t.$stickyTableHeader.css({visibility:"visible",top:i+"px",width:t.$tableScrollWrapper.innerWidth()+"px"});return}t.$stickyTableHeader.css({visibility:"hidden",width:"auto"})}else t.$stickyTableHeader.removeClass("fixed-solution"),s=400,i=r-u-1,i<0?i=0:i>f&&(i=f),h>0&&(i=i-h),o?(t.$stickyTableHeader.css({visibility:"visible"}),t.$stickyTableHeader.animate({top:i+"px"},s),t.$thead.css({visibility:"hidden"})):t.$stickyTableHeader.animate({top:"0"},s,function(){t.$thead.css({visibility:"visible"});t.$stickyTableHeader.css({visibility:"hidden"})})};t.prototype.setupHdrCells=function(){var t=this;t.$hdrCells.each(function(i){var u=n(this),r=u.prop("id"),o=u.text(),f,e;r||(r=t.idPrefix+i,u.prop("id",r));o===""&&(o=u.attr("data-col-name"));u.is("[data-priority]")&&(f=n('<li class="checkbox-row"><input type="checkbox" name="toggle-'+r+'" id="toggle-'+r+'" value="'+r+'" /> <label for="toggle-'+r+'">'+o+"<\/label><\/li>"),e=f.find("input"),t.$dropdownContainer.append(f),f.click(function(){e.prop("checked",!e.prop("checked"));e.trigger("change")}),n("html").hasClass("lt-ie9")&&e.click(function(){n(this).trigger("change")}),f.find("label").click(function(n){n.stopPropagation()}),f.find("input").click(function(n){n.stopPropagation()}).change(function(){var r=n(this),i=r.val(),u=t.$tableWrapper.find("#"+i+", #"+i+"-clone, [data-columns~="+i+"]");t.$table.hasClass("display-all")&&(n.proxy(t.preserveDisplayAll(),t),t.$table.removeClass("display-all"),t.$tableClone&&t.$tableClone.removeClass("display-all"),t.$displayAllBtn.removeClass("btn-primary"));u.each(function(){var t=n(this);r.is(":checked")?(t.css("display")!=="none"&&t.prop("colSpan",parseInt(t.prop("colSpan"))+1),t.show()):parseInt(t.prop("colSpan"))>1?t.prop("colSpan",parseInt(t.prop("colSpan"))-1):t.hide()})}).bind("updateCheck",function(){u.css("display")!=="none"?n(this).prop("checked",!0):n(this).prop("checked",!1)}).trigger("updateCheck"))})};t.prototype.setupStandardCells=function(){var t=this;t.$bodyRows.each(function(){var i=0;n(this).find("th, td").each(function(){for(var s,h,r=n(this),u="",f=r.prop("colSpan"),o=0,e=i;e<i+f;e++)u=u+" "+t.idPrefix+e,s=t.$tableScrollWrapper.find("#"+t.idPrefix+e),h=s.attr("data-priority"),h&&r.attr("data-priority",h),s.css("display")==="none"&&o++;f>1&&(r.addClass("spn-cell"),o!==f?r.show():r.hide());r.prop("colSpan",Math.max(f-o,1));u=u.substring(1);r.attr("data-columns",u);i=i+f})})};t.prototype.updateSpanningCells=function(){var t=this;t.$table.find(".spn-cell").each(function(){for(var t=n(this),f=t.attr("data-columns").split(" "),i=f.length,r=0,u=0;u<i;u++)n("#"+f[u]).css("display")==="none"&&r++;r!==i?t.show():t.hide();t.prop("colSpan",Math.max(i-r,1))})};i=n.fn.responsiveTable;n.fn.responsiveTable=function(i){return this.each(function(){var r=n(this),u=r.data("responsiveTable"),f=n.extend({},t.DEFAULTS,r.data(),typeof i=="object"&&i);f.pattern!==""&&(u||r.data("responsiveTable",u=new t(this,f)),typeof i=="string"&&u[i]())})};n.fn.responsiveTable.Constructor=t;n.fn.responsiveTable.noConflict=function(){return n.fn.responsiveTable=i,this};n(document).on("ready.responsive-table.data-api",function(){n("[data-pattern]").each(function(){var t=n(this);t.responsiveTable(t.data())})});n(document).on("click.dropdown.data-api",".dropdown-menu .checkbox-row",function(n){n.stopPropagation()});n(document).ready(function(){n("html").removeClass("no-js").addClass("js");r()?n("html").addClass("mq"):n("html").addClass("no-mq");u()?n("html").addClass("touch"):n("html").addClass("no-touch")})})(jQuery);
//# sourceMappingURL=rwd-table.min.js.map
